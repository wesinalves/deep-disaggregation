import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import MaxNLocator
from collections import namedtuple

lstm_mse = [0.002976994492928089, 0.002402347367594794, 0.0021010858073704018, 0.0020957907001159628, 
0.002466861657008231, 0.0022087736864807566, 0.0019326361200837246, 0.0022502778356951699, 
0.0021120247256082099, 0.0020234814159484325, 0.0019867337329047105, 0.0017512268001995495, 
0.0018022879651901525, 0.0017758519695235593, 0.0017383660651035572, 0.0017781343610199748, 
0.0019583919134276849, 0.0018340466467124763, 0.0015763219695394562, 0.0014871097244814426, 
0.0014047015920445253, 0.001452834220616856, 0.0014724433848050983, 0.002187954992012259, 
0.0018083552521196082, 0.001615388874083562, 0.0014882537390320343, 0.0015178265146918318, 
0.0018293197611744659, 0.0016402984513768147, 0.0014795266749205284, 0.0017605561670799221, 
0.0015528290901707801, 0.0018262237698914447, 0.0015764736027998692, 0.0014157769126197743, 
0.0013606587451414974, 0.0014589768155744726, 0.0015944351108444815, 0.0015278479807678358, 
0.0014122066895514598, 0.0014754303099743234, 0.001887518709908276, 0.0015137020250391724, 
0.0013198540123814937, 0.0013387027245657726, 0.0014198318666942282, 0.0017114708729980643, 
0.0013830990579929239, 0.0012835539858744086, 0.0013954243104567043, 0.0011307242645050967, 
0.0014946260270274417, 0.0012474503360551475, 0.0012638040689538915, 0.0012514981550442396, 
0.0017445938617064365, 0.0012652368468205489, 0.001125095351270906, 0.0011057800239458182, 
0.001092827494322546, 0.0013586316614241818, 0.0011551340776997394, 0.0010393590716355093, 
0.001025689331762711, 0.0011415933597708591, 0.0012644707465191752, 0.0011367903831968772, 
0.0011755985555474526, 0.0011250567796321244, 0.0010093243160209809, 0.0013425103695808131, 
0.0010634924218766292, 0.0011255431203459514, 0.001104724818180402, 0.001461946568624498, 
0.0012702008454638959, 0.001186451045595041, 0.0010223034338311733, 0.0011523701574155016]

lstm_acc = [0.300170597257138, 0.30472362306732748, 0.36645851490231351, 0.34286870208114528, 
0.31760333415300357, 0.34953777056103019, 0.41067500772012366, 0.34885431906742304, 
0.37752004596011735, 0.42214194596415189, 0.39276318781518693, 0.461318558311825, 0.46177925889691351,
 0.44862703480682398, 0.46479392642767614, 0.46276491735701974, 0.41694926183953507, 
 0.43491409618686894, 0.51094628642483886, 0.54039311963262637, 0.55866526571384212, 
 0.54527794709000244, 0.54277538584162643, 0.36453898573963361, 0.46035083078797812, 
 0.51137126393091525, 0.54063596318363372, 0.52948988099438654, 0.45487129464767617, 
 0.49145508375970592, 0.54224394399267584, 0.46040002515705813, 0.52587943274989124, 
 0.44573468043931663, 0.51631161197180031, 0.56056159629403535, 0.5791223235242684, 
 0.54675967479399978, 0.51315173557579175, 0.52711853386131136, 0.56214610205510696, 
 0.54325196892189109, 0.44619482271194522, 0.5369808966200188, 0.59363268544409409, 
 0.58414440916351795, 0.55821486179190893, 0.48550691315678018, 0.56975160830226246, 
 0.59711286678899778, 0.56402337943501835, 0.64044228422355987, 0.53835799251374394, 
 0.61460691477762563, 0.60674868035032348, 0.60730179537612972, 0.5006020361396738, 
 0.61496530889636769, 0.64723031820538679, 0.65166594827303603, 0.65391684334704403, 
 0.59166924562781831, 0.64300568324170804, 0.67567912023379384, 0.67931686593205343, 
 0.64306892638267321, 0.61215583896425907, 0.64462249320710252, 0.63365468840859029, 
 0.65139341671524631, 0.68127572341094667, 0.57480895469962556, 0.66782622298849548, 
 0.64997717314212444, 0.65918523583502697, 0.56034368867269024, 0.60709978577161783, 
 0.63113333259252369, 0.67691901482115391, 0.64317589967342981]

convz1_mse = [0.0021909047424061895, 0.0017461018671988877, 0.0018537058237880167, 0.0018668365521907167, 
0.0019257525675871307, 0.0019059425059935499, 0.0019334310180141195, 0.0018543327308807754, 
0.0021151339628844006, 0.0022609879018076454, 0.0019886020481351217, 0.0019029371714384688, 
0.0018390857788315664, 0.0020329491195301406, 0.0019277047977758811, 0.0024133556967269507, 
0.001985406633526587, 0.0019122650884860928, 0.0018077749245960998, 0.0020742577545039059, 
0.0019175192114288654, 0.0027455629444568404, 0.0019705470022846712, 0.0020752476223048501, 
0.0021425827501252307, 0.00196230979900805, 0.0019329040447541698, 0.001995224062034453, 
0.002247102948520719, 0.0019215598818090589, 0.0017649406761111395, 0.0017518912571568897, 
0.0019759719061807962, 0.0022015939085688334, 0.002189585022661979, 0.0021445793798375973, 
0.002706843473774069, 0.0018217313899564645, 0.0018938235350918567, 0.0019355882280643339, 
0.001845916437877672, 0.0020257246774848907, 0.0019020450670713233, 0.001848710237258803, 
0.0022114407853713186, 0.0020431282990662231, 0.0018940906998125785, 0.0021079884201425964, 
0.0020598697521731976, 0.0021110944220391636, 0.0020042923892107213, 0.0019976808360536646, 
0.0021098264677380059, 0.0019074685571642579, 0.0020519741426155546, 0.002088632870531001, 
0.002753955006718573, 0.0019334690802621901, 0.0019043293712557861, 0.0018513400616037403, 
0.0017221962456872822, 0.0022534684636440505, 0.0021969036307307559, 0.0018285159948588444, 
0.0018547083862883789, 0.0018306393024063274, 0.0020626391950498749, 0.0018595442768393675, 
0.0018486962426809939, 0.0019507624656905733, 0.0021406302871224401, 0.0019723074709769315, 
0.0020716590525329793, 0.0019787947765506943, 0.0020079565227043928, 0.0021104412139333283, 
0.0019023542960606671, 0.0021182158257738409, 0.0019306614702449374, 0.0018698054016459845]

convz1_acc = [0.37486547053767039, 0.48436632030367377, 0.4334215489883968, 0.456810901789097, 
0.47909519100113251, 0.45735547449342395, 0.44371372088808569, 0.4463918349841266, 
0.42221425333733964, 0.38430396152077517, 0.44817910435406028, 0.43240712302987738, 
0.45532990666577777, 0.4111004910898608, 0.40226623537208184, 0.35616993108170469, 
0.40415431300811699, 0.43795290547611931, 0.45468870285106588, 0.41316674533878317, 
0.41197777748006958, 0.33031924783332123, 0.42857887463671451, 0.41435025890021293, 
0.34243219031728933, 0.41629889458605707, 0.42602727842205002, 0.36869598479146315, 
0.39261402662641209, 0.41141574091774913, 0.45201615957304897, 0.4569745032650524, 
0.39499990147538833, 0.33883544048141967, 0.34589681845515008, 0.33041121661178885, 
0.33711153695113838, 0.41374132692133414, 0.43215969631339923, 0.40430959880213291, 
0.4554378178626669, 0.38360057831050132, 0.4279752316790969, 0.41484921584602441, 
0.39316067883735073, 0.36697421171150535, 0.39713198710568942, 0.34821984489562385, 
0.34859509836598157, 0.3518197697604255, 0.3657347691604963, 0.36398719291276982, 
0.34288190560747756, 0.45437021857536597, 0.40750798589451953, 0.35427808655591453, 
0.32974280644840315, 0.38353845678923826, 0.395167540786315, 0.44656995313207881, 
0.47732811774834205, 0.3784911076007903, 0.38743929849752223, 0.43564988854949649, 
0.4282337276629713, 0.44542324906725383, 0.35664844692057729, 0.44782247696458755, 
0.42542637008386952, 0.37805022353500428, 0.32773882697209611, 0.38007398292576511, 
0.40396456840831063, 0.37581517516465235, 0.36304795180672444, 0.35102980353485946, 
0.42753149459135764, 0.3431008962700649, 0.41259631645392603, 0.41854654640551237]

convz2_mse = [0.002650071361649348, 0.0026192506066457276, 0.0023603430386841353, 0.0022818749838148106, 
0.0023145270792791048, 0.0025429136638492342, 0.0023051809265180584, 0.0022976790795206721, 
0.0022964891629682215, 0.0022880162187147116, 0.0024058868181369396, 0.0022803044147542552, 
0.002290062254996682, 0.0023319898508520347, 0.0023478690606988832, 0.002311760890817945, 
0.0023141089118899573, 0.0023003094027919751, 0.0022801936078316689, 0.0023053041810636309, 
0.0022923936622084072, 0.0022803314327140339, 0.0023498168521954763, 0.002336746954961754, 
0.0022957400360091476, 0.0022793246033426594, 0.0022779543421143611, 0.0022816444952999926, 
0.0022873638946281278, 0.0022802966115405823, 0.002305810889888669, 0.0022809890735098668, 
0.0022876421251967639, 0.0022792258244232304, 0.0022780037381241497, 0.0022799054455077301, 
0.0022849233989045079, 0.002285291400538088, 0.0022817905075342162, 0.0022889263513015509, 
0.0022879241341951465, 0.0022806599972730302, 0.0022816148535498904, 0.0022797169785656779, 
0.0022806759732440997, 0.0022783467330525762, 0.0022847242519794882, 0.0022986902912402836, 
0.0022940682013836101, 0.00229350176041565, 0.0022988011763984827, 0.0022839558354341085, 
0.0022883498273205574, 0.0022779686223883041, 0.0023040591066278548, 0.0023651104864068576, 
0.0022811809502262283, 0.0023610516801084768, 0.0023120130937000437, 0.0022966229135467716, 
0.0023106429262897267, 0.0022885440821039942, 0.0023320393692377954, 0.0023118682310577839, 
0.0023295483436193182, 0.0023176890128892326, 0.0023418050584530945, 0.0023095862210346946, 
0.0023270971555597398, 0.00227961718807904, 0.0023022650318797527, 0.0023044645751169033, 
0.0023114584177941805, 0.002329745259957701, 0.0023226356671937516, 0.0023706379488227032, 
0.0022975703758194035, 0.0022836898948632913, 0.0023249672142068045, 0.0023073248884830644]

convz2_acc = [0.44985997911878506, 0.44461166264007645, 0.39614489631331096, 0.36305892214983693, 
0.37783834906384106, 0.42904600886926547, 0.36713975217365025, 0.35393914846659458, 
0.37235698974746922, 0.36769342257009774, 0.40717358264605974, 0.34895788730726307, 
0.33603435156877204, 0.31660457503860961, 0.31333739853498899, 0.38219565741873296, 
0.33553363268760272, 0.37673757567152821, 0.36064329226698555, 0.37907764047333314, 
0.33603017076674468, 0.35015778571447775, 0.31155541431967071, 0.31487812908592527, 
0.37261746250269512, 0.34740904415674823, 0.3525271820088044, 0.36266180257803571, 
0.3666865265894973, 0.35623592896112488, 0.37778507580997733, 0.35054701045544656, 
0.3552011394022323, 0.35875166526770741, 0.35147834335850658, 0.34611064751393505, 
0.33985195932521306, 0.33947975468159564, 0.35030741156832246, 0.33641076096717115, 
0.33722611526490665, 0.34481821812142921, 0.34347242903689268, 0.35460120162544617, 
0.34659102356535787, 0.35003824831613473, 0.34001605134246859, 0.33020946410805652, 
0.33292089413769477, 0.33413038430682052, 0.33014836612977039, 0.34077969206084513, 
0.3368908946200917, 0.35257577034518861, 0.32971510079920574, 0.30626713118510984, 
0.34970433021293368, 0.30727924598031064, 0.32393003405750831, 0.33165696608872697, 
0.32436767297788294, 0.33674018861862876, 0.31644675997153737, 0.3238261302916815,
 0.31699215711992945, 0.32141327302548872, 0.31293058177408062, 0.32488929109372211, 
 0.31786003001355412, 0.34676683246999518, 0.32852745648544535, 0.32729967254297665, 
 0.32464590019559558, 0.31692192044898648, 0.31949891893652804, 0.30470004482723978, 
 0.33083613210345097, 0.34370075926105048, 0.31863359130485525, 0.32585751457911072]

gru_mse = [0.0040267278451858448, 0.0035375644843977532, 0.0040284083916547336, 0.003480268906832239, 
0.0032218134585665923, 0.0031656199668124254, 0.0031177450666341243, 0.0030683085267760547, 
0.0029395054400880973, 0.0031477778656440083, 0.0034292419817799394, 0.0036202316195943253, 
0.0029617822631373874, 0.0032264675699056394, 0.0030628074911799386, 0.0030304265544631786, 
0.0029289841202202521, 0.0033327644042613317, 0.0030018845821247588, 0.0028543212121728912, 
0.0034412601940758043, 0.0042241991027928121, 0.0042646402084070886, 0.0041046019540685041, 
0.0037675969265178102, 0.0047421388954804466, 0.0047871920810207049, 0.0038660585605985905, 
0.0027000032854106993, 0.0031140200310938496, 0.0029162464416003786, 0.0028122541171136592, 
0.0030257889963263862, 0.0042811656709240541, 0.0027457388984645425, 0.0044135263563239028, 
0.0035387278536066721, 0.0044469435492766485, 0.0057513679771234397, 0.0047919279030581609, 
0.0051338972409386572, 0.0042189226791977067, 0.0035251835616279953, 0.0033733927156801707, 
0.0031029663691759645, 0.0034526338440378848, 0.003297428587333567, 0.0037194395147595706, 
0.003177470584401593, 0.0032543778259622905, 0.0028960157445135962, 0.002556766823495496, 
0.0032212708945436345, 0.0016513095294724996, 0.0014498644048042677, 0.0015163054572751632, 
0.0012831360429167756, 0.0011239609871341125, 0.0017297185973080085, 0.0015613367919186576, 
0.0026027250657023938, 0.002457216243683807, 0.0013768984717899002, 0.0012093376478818979, 
0.0019668087429823098, 0.0013959361922513368, 0.0016803893874928017, 0.0027583267159795081, 
0.001312054848038888, 0.0012615478879350319, 0.0036196795667757676, 0.0016616152947603515, 
0.0021235640827536087, 0.002407938780578823, 0.0030247801292866265, 0.0036841578606583102, 
0.0017563136017300055, 0.00342432018237871, 0.0030337978319475451, 0.0018541578658735252]


gru_accuracy = [0.75586360321320734, 0.81261042507729431, 0.77218557212055683, 0.80177285693067979, 
0.83373782145467146, 0.84180987376329086, 0.84845314815449591, 0.85111497568840866, 
0.85812344757160153, 0.84254261160308719, 0.81692112077694867, 0.79377601693571875, 
0.87842139061488456, 0.83577465421898545, 0.85170948065582663, 0.84797646511727554, 
0.87247083028866823, 0.81817778901357674, 0.86054746752518807, 0.87090393807316369, 
0.82667379844480215, 0.73891130302307628, 0.76798345726157091, 0.74991917405988462, 
0.77816657117874888, 0.79551192118243408, 0.78364717678324858, 0.80561549136109134, 
0.86546333095772854, 0.84749489293238489, 0.87170543303400894, 0.87247629594507359, 
0.86700175449502559, 0.83202587902778369, 0.86410902156490121, 0.78058323919822947, 
0.86591686504813992, 0.85337429677244814, 0.75648103773734376, 0.8565649771537005, 
0.85394840782258352, 0.80094296081944982, 0.7960081184747877, 0.818513608127865, 
0.81336599390496256, 0.783048618499536, 0.78795168824581252, 0.7834687829741972, 
0.80388492771809683, 0.82472752702842578, 0.83354793665549454, 0.84945788335756489, 
0.8493115468794139, 0.89581492724320189, 0.9113406716105602, 0.91108448762043881, 
0.91209858905638841, 0.91900996703452764, 0.89093660040668032, 0.89166461941696473, 
0.8441503303195943, 0.87281246563280623, 0.89352036092534126, 0.90462909633450228, 
0.87708168268874198, 0.91569480988878871, 0.87953005485888658, 0.85744368623102185, 
0.89949827205441257, 0.90241396150837805, 0.79578088117231849, 0.88452956409334094, 
0.85694994000335045, 0.83375490365641425, 0.83705003440809345, 0.7786323434947704, 
0.87836779983917446, 0.80709468846684029, 0.82698695838994385, 0.86085702119075236]

line_style = ['r--','bs','g^','yo']
labels = ['LSTM-k','CONV-s','CONV-p','proposed']
errors = [lstm_mse, convz1_mse, convz2_mse, gru_mse]
accuracies = [lstm_acc, convz1_acc, convz2_acc, gru_accuracy]
opacity = 0.4

ax = plt.subplot(2,1,1)
for i,accuracy in enumerate(accuracies):
	ax.set_ylabel('Accuracy')
	plt.plot(accuracy,line_style[i], label=labels[i], alpha=opacity)

plt.xticks(np.arange(0,80,4))
ax.set_xticklabels(np.arange(1,81,4))
ax = plt.subplot(2,1,2)
for i,error in enumerate(errors):
	ax.set_ylabel('MSE')
	plt.plot(error,line_style[i], label=labels[i], alpha=opacity)



plt.xlabel('Sample percent (%)')
plt.xticks(np.arange(0,80,4))
ax.set_xticklabels(np.arange(1,81,4))
plt.legend()
plt.show()

for i,accuracy in enumerate(accuracies):
	print('=========================================================')
	print('Method {}: mean acc {}, var acc {}, std acc {}'.format(labels[i],np.mean(accuracy), np.var(accuracy, ddof=1), np.std(accuracy) ))
	print('Method {}: mean mse {}, var mse {}, std mse {}'.format(labels[i],np.mean(errors[i]), np.var(errors[i], ddof=1), np.std(errors[i]) ))
	print('=========================================================')